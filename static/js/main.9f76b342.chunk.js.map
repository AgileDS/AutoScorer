{"version":3,"sources":["api.js","login/Login.jsx","register/Register.jsx","components/MultiBrush.jsx","components/TimeSeriesPlot.jsx","dashboard/Dashboard.jsx","dashboard/UploadForm.jsx","App.js","serviceWorker.js","index.js"],"names":["storage","TOKEN","server","console","log","process","headers","set_token","token","localStorage","getItem","Authorization","loginForm","a","axios","post","response","status","data","setItem","registerForm","Error","defaults","xsrfHeaderName","xsrfCookieName","selectionsToApi","selections","array","Object","entries","key","value","push","apiToSelections","api_data","result","forEach","elem","index","score","name","size","get","rows","Login","props","handleChange","event","target","setState","update_string","handleSubmit","preventDefault","state","username","loginReq","password","then","server_error","history","err_element","this","Alert","variant","align","Jumbotron","Form","onSubmit","className","style","Group","controlId","Label","Control","md","type","onChange","Button","to","React","Component","withRouter","validateForm","errors","valid","values","val","length","Register","start","confirm_password","registerReq","MultiBrush","hasNullBrush","timeRanges","handleMouseClick","e","brushIndex","onTimeRangeClicked","isBrushing","handleBrushMouseDown","bind","handleOverlayMouseDown","handleHandleMouseDown","handleMouseUp","handleMouseMove","width","timeScale","viewBeginTime","invert","viewEndTime","TimeRange","brush_idx","x","pageX","y","pageY","xy0","Math","round","begin","end","document","addEventListener","brushingInitializationSite","initialBrushBeginTime","initialBrushEndTime","initialBrushXYPosition","allowFreeDrawing","offset","getElementOffset","overlay","left","t","getTime","drawingPosition","handle","removeEventListener","brushing_is","onUserMouseUp","xy","viewport","newBegin","newEnd","tb","te","xx","timeOffset","startOffsetConstraint","endOffsetConstrain","parseInt","onTimeRangeChanged","cursor","height","overlayStyle","fill","opacity","ref","c","onClick","onMouseDown","onMouseUp","timeRange","idx","brushDefaultStyle","fillOpacity","stroke","shapeRendering","userStyle","brushStyle","merge","userText","text","userTextStyle","textStyle","disjoint","range","intersection","bounds","pointerEvents","handleStyle","toJSON","handleSize","leftHandleBounds","rightHandleBounds","onMouseMove","renderOverlay","map","renderBrush","renderHandles","defaultProps","upDownStyle","styler","color","TimeSeriesPlot","formatter","tracker","format","position","trackerX","backgroundColor","marginLeft","trackerEventIn","timerange","trackerPosition","onTrackerChanged","handleTrackerChanged","enablePanZoom","maxTime","minTime","minDuration","onBackgroundClick","handleTimeRangeChange","debug","axis","series","columns","i","selected","getText","getTextStyle","allowSelectionClear","handleSelectionChange","id","label","labelOffset","min","minSignal","max","maxSignal","absolute","visibleNumPeriods","selectedAt","secondsInPeriod","labels_dict","0","1","2","labelsInput","totalRecords","helpPopover","Popover","Title","as","Content","predict","model","tensor","tf","array_to_tensor","prediction","dataSync","prediction_arr","Array","from","indexOf","_","breakTimeRange","t0","t1","numCuts","period","floor","apply","n","initTime","finalTime","Dashboard","qualifications","offsetData","scale","trackerEventIn_EEG","EEG","at","bisect","trackerEventIn_EMG","EMG","trackerEventOut_EEG","trackerEventOut_EMG","selection","newSelected","getPrediction","pred","valEEG","edf","getPhysicalSignalConcatRecords","valEMG","concat","Float32Array","edfParser","getNumberOfRecords","getRawSignal","secondsInRecord","getRecordDuration","beginTime","getRecordingStartDate","valuesEEG","multiplier","timeSeriesEEG","slice","p","TimeSeries","points","valuesEMG","timeSeriesEMG","_handleKeyDown","showAlert","eventKey","keys","parsed","send_selections","sendQualificationsReq","success","blur","load_selections","window","confirm","getQualifications","debounce","prevProps","prevState","Row","role","Spinner","animation","OverlayTrigger","trigger","placement","tabindex","UploadForm","spinner","setFile","accept","file","files","filename","EdfDecoder","reader","FileReader","onloadend","decoder","buff","setInput","decode","handleData","getOutput","readAsArrayBuffer","App","basename","exact","path","Boolean","location","hostname","match","ReactDOM","render","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.9f76b342.chunk.js","sourcesContent":["import axios from 'axios';\r\n\r\nconst storage = {\r\n    TOKEN: 'AutoScorer-Token'\r\n};\r\n\r\nvar server = \"http://localhost:8000\";\r\n// var server = \"https://fierce-citadel-47273.herokuapp.com\";\r\nif (process.env.NODE_ENV === 'production') {\r\n    server =  'https://fierce-citadel-47273.herokuapp.com';\r\n}\r\n\r\nconsole.log(\"server url:\", server, process.env.NODE_ENV);\r\nserver = server + \"/api\"\r\n\r\nvar headers = {\r\n    // 'Content-Type': 'application/json',\r\n    // \"Access-Control-Allow-Origin\": \"*\",\r\n    // 'Access-Control-Allow-Credentials': 'true'\r\n}\r\n\r\nvar set_token = function(token) {\r\n    token = token || localStorage.getItem(storage.TOKEN);\r\n    headers.Authorization = 'Token ' + token;\r\n}\r\n\r\nset_token(null);\r\n\r\naxios.defaults.xsrfHeaderName = \"X-CSRFTOKEN\";\r\naxios.defaults.xsrfCookieName = \"csrftoken\";\r\n\r\n\r\nexport async function loginReq(loginForm) {\r\n    console.log(\"lolw\", loginForm, server)\r\n    try {\r\n        let response = await axios.post(server + \"/api-token-auth/\", loginForm)\r\n        if (response.status === 200 && response.data.token) {\r\n            console.log(response);\r\n            localStorage.setItem(storage.TOKEN, response.data.token);\r\n            set_token(response.data.token);\r\n            return true;\r\n        }\r\n        console.log(\"Response not ok\", response)\r\n        return false;\r\n    } catch (err) {\r\n        console.log(\"error\", err);\r\n        return false;\r\n    }\r\n}\r\n\r\nexport async function registerReq(registerForm) {\r\n    try {\r\n        let response = await axios.post(server + \"/create-user/\", registerForm)\r\n        if (response.data.token) {\r\n            console.log(\"registerReq\", response)\r\n            localStorage.setItem(storage.TOKEN, response.data.token);\r\n            set_token(response.data.token);\r\n            return true;\r\n        } else if (response.data.Error) {\r\n            return response.data.Error;\r\n        }\r\n        console.log(\"Response not ok\", response)\r\n        return false;\r\n    } catch (err) {\r\n        console.log(\"error\", err);\r\n        return false;\r\n    }\r\n}\r\n\r\nvar selectionsToApi = function(selections) {\r\n    let array = [];\r\n    for (const [key, value] of Object.entries(selections)) {\r\n        // console.log(key, value);\r\n        array.push({\r\n            'index': key,\r\n            'score': value\r\n        });\r\n    }\r\n    return array\r\n}\r\n\r\nvar apiToSelections = function(api_data) {\r\n    let result = {}\r\n    // console.log(\"what I got\", api_data);\r\n    api_data.forEach((elem) => {\r\n        result[elem.index] = elem.score;\r\n    })\r\n    // console.log(\"apitoSel\", result)\r\n    return result;\r\n}\r\n\r\nexport async function sendQualificationsReq(name, size, selections) {\r\n    let data = {\r\n        'name': name,\r\n        'size': size,\r\n        'rows': selectionsToApi(selections)\r\n    }\r\n    console.log(\"api\", data)\r\n    try {\r\n        let response = await axios.post(server + \"/update-create-dataset/\", data, {headers: headers})\r\n        if (response.status >= 200 && response.status < 300)\r\n            return true;\r\n        console.log(\"send qualification failed? \", response.status)\r\n        return false;\r\n    } catch (e) {\r\n        console.log(\"error\", e);\r\n        return false;\r\n    }\r\n}\r\n\r\nexport async function getQualifications(name) {\r\n    try {\r\n        let response = await axios.get(server + '/ds/' + name, {headers: headers})\r\n        if (response.status >= 200 && response.status < 300) {\r\n            // console.log(response.data)\r\n            return apiToSelections(response.data.rows);\r\n        }\r\n        return false;\r\n    } catch (e) {\r\n        console.log(\"error\", e);\r\n        return false;\r\n    }\r\n}\r\n\r\nexport async function listQualifications() {\r\n    try {\r\n        let response = await axios.get(server + '/dataset_list/', {headers: headers})\r\n        if (response.status >= 200 && response.status < 300) {\r\n            // console.log(response.data)\r\n            return response.data;\r\n        }\r\n        return false;\r\n    } catch (e) {\r\n        console.log(\"error\", e);\r\n        return false;\r\n    }\r\n}\r\n\r\n","import React from 'react';\r\nimport {Link, withRouter} from \"react-router-dom\";\r\nimport Form from \"react-bootstrap/Form\";\r\nimport Button from \"react-bootstrap/Button\";\r\nimport {loginReq} from \"../api\";\r\nimport Jumbotron from \"react-bootstrap/Jumbotron\";\r\nimport Alert from \"react-bootstrap/Alert\";\r\n\r\nclass Login extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            username: '',\r\n            password: '',\r\n            update_string: 'just to annoy you',\r\n            server_error: ''\r\n        };\r\n    }\r\n\r\n    handleChange = (event) => {\r\n        switch (event.target.name) {\r\n            case \"username\":\r\n                this.setState({update_string: \"Welcome back \" + event.target.value});\r\n                break;\r\n            case \"password\":\r\n                // this.setState({update_string:   \"HAHA I know your password \" + this.state.username\r\n                //                                 + \"!! its \" + event.target.value})\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        this.setState({[event.target.name]: event.target.value});\r\n    };\r\n\r\n    handleSubmit = (event) => {\r\n        event.preventDefault();\r\n        console.log('A name was submitted: ' + this.state.username);\r\n        let payload = {\r\n            \"username\": this.state.username,\r\n            \"password\": this.state.password\r\n        }\r\n        loginReq(payload).then(response => {\r\n            console.log(\"LoginPage\", response)\r\n            if (response === false) {\r\n                this.setState({server_error: \"Username or password is incorrect\"});\r\n            } else {\r\n                this.props.history.push('/dashboard');\r\n            }\r\n        });\r\n    };\r\n\r\n    render() {\r\n        let err_element;\r\n        if (this.state.server_error) {\r\n            err_element = <Alert variant=\"danger\"> {this.state.server_error} </Alert>;\r\n        }\r\n        return (\r\n            <div align=\"center\">\r\n                <Jumbotron>\r\n                    <h1>Hello to your favourite AutoScorer!</h1>\r\n                    <p> Sign in to get into your dashboard </p>\r\n                </Jumbotron>\r\n                <Form onSubmit={this.handleSubmit} align='left' className=\"mt-5\" style={{'maxWidth': 20 + 'em'}}>\r\n                    <Form.Group controlId=\"formBasicUsername\">\r\n                        <Form.Label>Enter your username</Form.Label>\r\n                        <Form.Control md=\"auto\" name='username' type=\"text\" value={this.state.username}\r\n                                      onChange={this.handleChange}/>\r\n                    </Form.Group>\r\n                    <Form.Group controlId=\"formBasicPassword\">\r\n                        <Form.Label>Password</Form.Label>\r\n                        <Form.Control md=\"auto\" name='password' type=\"password\" value={this.state.password}\r\n                                      onChange={this.handleChange}/>\r\n                    </Form.Group>\r\n                    {err_element}\r\n\r\n                    <div align=\"center\" className='mt-3 pt-3'>\r\n                        <Button variant=\"primary\" type=\"submit\">\r\n                            Log in\r\n                        </Button>\r\n                        <br/>\r\n                        <Link to='/register'>Don't have an account? Sign Up</Link>\r\n                    </div>\r\n                </Form>\r\n                {/*<p>AutoScorer feedback: {this.state.update_string}</p>*/}\r\n                <br/>\r\n                {/*<Link to=\"/dashboard\">Dashboard</Link>*/}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default withRouter(Login);\r\n  ","import {withRouter} from \"react-router-dom\";\r\nimport React from \"react\";\r\nimport Form from \"react-bootstrap/Form\";\r\nimport Button from \"react-bootstrap/Button\";\r\nimport {registerReq} from \"../api\";\r\nimport Jumbotron from \"react-bootstrap/Jumbotron\";\r\nimport Alert from \"react-bootstrap/Alert\";\r\nimport {\r\n    Link\r\n} from \"react-router-dom\";\r\nconst validateForm = (errors) => {\r\n    let valid = true;\r\n    Object.values(errors).forEach(\r\n        // if we have an error string set valid to false\r\n        (val) => val.length > 0 && (valid = false)\r\n    );\r\n    return valid;\r\n}\r\n\r\nclass Register extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            username: '',\r\n            password: '',\r\n            confirm_password: '',\r\n            errors: {\r\n                start: 'error',\r\n                username: '',\r\n                password: '',\r\n                confirm_password: ''\r\n            },\r\n            server_error: ''\r\n        };\r\n    }\r\n\r\n    handleChange = (event) => {\r\n        event.preventDefault();\r\n        const {name, value} = event.target;\r\n        let errors = this.state.errors;\r\n\r\n        switch (name) {\r\n            case 'username':\r\n                errors.username = value.length < 4\r\n                    ? 'Username must be at least 4 characters long' : '';\r\n                errors.start = '';\r\n                break;\r\n            case 'password':\r\n                errors.password = value.length < 4\r\n                    ? 'Password must be at least 4 characters long'\r\n                    : '';\r\n                break;\r\n            case 'confirm_password':\r\n                errors.confirm_password = (value !== this.state.password)\r\n                    ? 'Password inputs must match'\r\n                    : '';\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        this.setState({[event.target.name]: event.target.value, errors});\r\n    };\r\n\r\n\r\n    handleSubmit = (event) => {\r\n        event.preventDefault();\r\n        if (!validateForm(this.state.errors)) {\r\n            console.log(\"Submit not valid!\")\r\n            this.setState({server_error: \"Please fill the form correctly\"});\r\n            return;\r\n        }\r\n        console.log('A name was submitted: ' + this.state.username);\r\n        let payload = {\r\n            \"username\": this.state.username,\r\n            \"password\": this.state.password,\r\n            \"confirm_password\": this.state.confirm_password\r\n        }\r\n        registerReq(payload).then(response => {\r\n            console.log(\"RegisterPage\", response)\r\n            if (response === false) {\r\n                this.setState({update_string: \"There was error with your registration\"});\r\n            } else if (typeof  response === \"string\") {\r\n                this.setState({server_error: response});\r\n            } else {\r\n                this.props.history.push('/dashboard');\r\n            }\r\n        });\r\n    };\r\n\r\n    render() {\r\n        let err_element;\r\n        if (this.state.server_error) {\r\n            err_element = <Alert variant=\"danger\"> {this.state.server_error} </Alert>;\r\n        }\r\n        return (\r\n            <div align=\"center\">\r\n                <Jumbotron>\r\n                    <h1>Hello to your favourite AutoScorer!</h1>\r\n                    <p> Register to get into your dashboard </p>\r\n                </Jumbotron>\r\n                <Form onSubmit={this.handleSubmit} className=\"mt-3\" align='left' style={{'maxWidth': 20 + 'em'}}>\r\n                    <br/>\r\n                    <Form.Group controlId=\"formRegisterUsername\">\r\n                        <Form.Label>Enter your username</Form.Label>\r\n                        <Form.Control name='username' type=\"text\"\r\n                                      value={this.state.username} onChange={this.handleChange}/>\r\n                        <p className=\"font-weight-light\"> {this.state.errors.username} </p>\r\n                    </Form.Group>\r\n                    <Form.Group controlId=\"formRegisterPassword\">\r\n                        <Form.Label>Your password</Form.Label>\r\n                        <Form.Control name='password' type=\"password\"\r\n                                      value={this.state.password} onChange={this.handleChange}/>\r\n                        <p className=\"font-weight-light\"> {this.state.errors.password} </p>\r\n\r\n                        <Form.Label>Confirm your password</Form.Label>\r\n                        <Form.Control name='confirm_password' type=\"password\"\r\n                                      value={this.state.confirm_password} onChange={this.handleChange}/>\r\n                        <p className=\"font-weight-light\"> {this.state.errors.confirm_password} </p>\r\n                    </Form.Group>\r\n\r\n                    {err_element}\r\n\r\n                    <div align=\"center\" className='mt-3 pt-3 btn-block'>\r\n\r\n                        <Button className='col-md-8' variant=\"primary\" type=\"submit\">\r\n                            Register\r\n                        </Button>\r\n                        <Link to='/login'><Button className='col-md-4 text-right' align=\"right\" variant=\"link\" >\r\n                            Log in\r\n                        </Button></Link>\r\n                    </div>\r\n                    <br/>\r\n                </Form>\r\n                <br/>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default withRouter(Register);","/**\r\n *  Copyright (c) 2016, The Regents of the University of California,\r\n *  through Lawrence Berkeley National Laboratory (subject to receipt\r\n *  of any required approvals from the U.S. Dept. of Energy).\r\n *  All rights reserved.\r\n *\r\n *  This source code is licensed under the BSD-style license found in the\r\n *  LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport merge from \"merge\";\r\nimport React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { TimeRange } from \"pondjs\";\r\n\r\nimport { getElementOffset } from \"react-timeseries-charts/lib/js/util\";\r\n\r\n/**\r\n * Renders a brush with the range defined in the prop `timeRange`.\r\n */\r\nexport default class MultiBrush extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            isBrushing: false\r\n        };\r\n\r\n        this.handleBrushMouseDown = this.handleBrushMouseDown.bind(this);\r\n        this.handleOverlayMouseDown = this.handleOverlayMouseDown.bind(this);\r\n        this.handleHandleMouseDown = this.handleHandleMouseDown.bind(this);\r\n        this.handleMouseUp = this.handleMouseUp.bind(this);\r\n        this.handleMouseMove = this.handleMouseMove.bind(this);\r\n    }\r\n\r\n    viewport() {\r\n        const { width, timeScale } = this.props;\r\n        const viewBeginTime = timeScale.invert(0);\r\n        const viewEndTime = timeScale.invert(width);\r\n        return new TimeRange(viewBeginTime, viewEndTime);\r\n    }\r\n\r\n    //\r\n    // Event handlers\r\n    //\r\n\r\n    handleBrushMouseDown(e, brush_idx) {\r\n        e.preventDefault();\r\n\r\n        const { pageX: x, pageY: y } = e;\r\n        const xy0 = [Math.round(x), Math.round(y)];\r\n        const begin = +this.props.timeRanges[brush_idx].begin();\r\n        const end = +this.props.timeRanges[brush_idx].end();\r\n\r\n        document.addEventListener(\"mouseup\", this.handleMouseUp);\r\n\r\n        this.setState({\r\n            isBrushing: true,\r\n            brushingInitializationSite: \"brush\",\r\n            initialBrushBeginTime: begin,\r\n            initialBrushEndTime: end,\r\n            initialBrushXYPosition: xy0,\r\n            brushIndex: brush_idx\r\n        });\r\n    }\r\n\r\n    handleOverlayMouseDown(e) {\r\n        if (this.props.allowFreeDrawing || this.hasNullBrush()) {\r\n            e.preventDefault();\r\n\r\n            const offset = getElementOffset(this.overlay);\r\n            const x = e.pageX - offset.left;\r\n            const t = this.props.timeScale.invert(x).getTime();\r\n\r\n            document.addEventListener(\"mouseup\", this.handleMouseUp);\r\n\r\n            const drawingPosition = this.props.allowFreeDrawing\r\n                ? this.props.timeRanges.length\r\n                : this.props.timeRanges.length - 1;\r\n\r\n            this.setState({\r\n                isBrushing: true,\r\n                brushingInitializationSite: \"overlay\",\r\n                initialBrushBeginTime: t,\r\n                initialBrushEndTime: t,\r\n                initialBrushXYPosition: null,\r\n                brushIndex: drawingPosition\r\n            });\r\n        }\r\n    }\r\n\r\n    hasNullBrush = () => {\r\n        return (\r\n            (this.props.timeRanges || []).length > 0 &&\r\n            this.props.timeRanges[this.props.timeRanges.length - 1] == null\r\n        );\r\n    };\r\n\r\n    handleMouseClick = (e, brushIndex) => {\r\n        if (this.props.onTimeRangeClicked) {\r\n            this.props.onTimeRangeClicked(brushIndex);\r\n        }\r\n    };\r\n\r\n    handleHandleMouseDown(e, handle, brushIndex) {\r\n        e.preventDefault();\r\n\r\n        const { pageX: x, pageY: y } = e;\r\n        const xy0 = [Math.round(x), Math.round(y)];\r\n        const begin = this.props.timeRanges[brushIndex].begin().getTime();\r\n        const end = this.props.timeRanges[brushIndex].end().getTime();\r\n\r\n        document.addEventListener(\"mouseover\", this.handleMouseMove);\r\n        document.addEventListener(\"mouseup\", this.handleMouseUp);\r\n\r\n        this.setState({\r\n            isBrushing: true,\r\n            brushingInitializationSite: `handle-${handle}`,\r\n            initialBrushBeginTime: begin,\r\n            initialBrushEndTime: end,\r\n            initialBrushXYPosition: xy0,\r\n            brushIndex: brushIndex\r\n        });\r\n    }\r\n\r\n    handleMouseUp(e) {\r\n        e.preventDefault();\r\n\r\n        document.removeEventListener(\"mouseover\", this.handleMouseMove);\r\n        document.removeEventListener(\"mouseup\", this.handleMouseUp);\r\n\r\n        const brushing_is = this.state.brushIndex;\r\n        this.setState(\r\n            {\r\n                isBrushing: false,\r\n                brushingInitializationSite: null,\r\n                initialBrushBeginTime: null,\r\n                initialBrushEndTime: null,\r\n                initialBrushXYPosition: null,\r\n                brushIndex: null\r\n            },\r\n            () => {\r\n                if (this.props.onUserMouseUp) {\r\n                    this.props.onUserMouseUp(brushing_is);\r\n                }\r\n            }\r\n        );\r\n    }\r\n\r\n    handleMouseMove(e) {\r\n        e.preventDefault();\r\n\r\n        const x = e.pageX;\r\n        const y = e.pageY;\r\n        const xy = [Math.round(x), Math.round(y)];\r\n        const viewport = this.viewport();\r\n\r\n        if (this.state.isBrushing) {\r\n            let newBegin;\r\n            let newEnd;\r\n\r\n            const tb = this.state.initialBrushBeginTime;\r\n            const te = this.state.initialBrushEndTime;\r\n\r\n            if (this.state.brushingInitializationSite === \"overlay\") {\r\n                const offset = getElementOffset(this.overlay);\r\n                const xx = e.pageX - offset.left;\r\n                const t = this.props.timeScale.invert(xx).getTime();\r\n                if (t < tb) {\r\n                    newBegin = t < viewport.begin().getTime() ? viewport.begin() : t;\r\n                    newEnd = tb > viewport.end().getTime() ? viewport.end() : tb;\r\n                } else {\r\n                    newBegin = tb < viewport.begin().getTime() ? viewport.begin() : tb;\r\n                    newEnd = t > viewport.end().getTime() ? viewport.end() : t;\r\n                }\r\n            } else {\r\n                const xy0 = this.state.initialBrushXYPosition;\r\n                let timeOffset =\r\n                    this.props.timeScale.invert(xy0[0]).getTime() -\r\n                    this.props.timeScale.invert(xy[0]).getTime();\r\n\r\n                // Constrain\r\n                let startOffsetConstraint = timeOffset;\r\n                let endOffsetConstrain = timeOffset;\r\n                if (tb - timeOffset < viewport.begin()) {\r\n                    startOffsetConstraint = tb - viewport.begin().getTime();\r\n                }\r\n                if (te - timeOffset > viewport.end()) {\r\n                    endOffsetConstrain = te - viewport.end().getTime();\r\n                }\r\n\r\n                newBegin =\r\n                    this.state.brushingInitializationSite === \"brush\" ||\r\n                    this.state.brushingInitializationSite === \"handle-left\"\r\n                        ? parseInt(tb - startOffsetConstraint, 10)\r\n                        : tb;\r\n                newEnd =\r\n                    this.state.brushingInitializationSite === \"brush\" ||\r\n                    this.state.brushingInitializationSite === \"handle-right\"\r\n                        ? parseInt(te - endOffsetConstrain, 10)\r\n                        : te;\r\n\r\n                // Swap if needed\r\n                if (newBegin > newEnd) [newBegin, newEnd] = [newEnd, newBegin];\r\n            }\r\n\r\n            if (this.props.onTimeRangeChanged) {\r\n                this.props.onTimeRangeChanged(\r\n                    new TimeRange(newBegin, newEnd),\r\n                    this.state.brushIndex\r\n                );\r\n            }\r\n        }\r\n    }\r\n\r\n    //\r\n    // Render\r\n    //\r\n\r\n    renderOverlay() {\r\n        const { width, height } = this.props;\r\n\r\n        let cursor;\r\n        switch (this.state.brushingInitializationSite) {\r\n            case \"handle-right\":\r\n            case \"handle-left\":\r\n                cursor = \"ew-resize\";\r\n                break;\r\n            case \"brush\":\r\n                cursor = \"move\";\r\n                break;\r\n            default:\r\n                cursor =\r\n                    this.props.allowFreeDrawing || this.hasNullBrush() ? \"crosshair\" : \"default\";\r\n        }\r\n\r\n        const overlayStyle = {\r\n            fill: \"white\",\r\n            opacity: 0,\r\n            cursor\r\n        };\r\n        return (\r\n            <rect\r\n                ref={c => {\r\n                    this.overlay = c;\r\n                }}\r\n                x={0}\r\n                y={0}\r\n                width={width}\r\n                height={height}\r\n                style={overlayStyle}\r\n                onClick={this.handleMouseClick}\r\n                onMouseDown={this.handleOverlayMouseDown}\r\n                onMouseUp={this.handleMouseUp}\r\n            />\r\n        );\r\n    }\r\n\r\n    renderBrush(timeRange, idx) {\r\n        const { timeScale, height } = this.props;\r\n\r\n        if (!timeRange) {\r\n            return <g />;\r\n        }\r\n\r\n        let cursor;\r\n        switch (this.state.brushingInitializationSite) {\r\n            case \"handle-right\":\r\n            case \"handle-left\":\r\n                cursor = \"ew-resize\";\r\n                break;\r\n            case \"overlay\":\r\n                cursor =\r\n                    this.props.allowFreeDrawing || this.hasNullBrush() ? \"crosshair\" : \"default\";\r\n                break;\r\n            default:\r\n                cursor = \"move\";\r\n        }\r\n\r\n        // Style of the brush area\r\n        const brushDefaultStyle = {\r\n            fill: \"#777\",\r\n            fillOpacity: 0.3,\r\n            stroke: \"#fff\",\r\n            shapeRendering: \"crispEdges\",\r\n            cursor\r\n        };\r\n        const userStyle = this.props.style ? this.props.style(idx) : {};\r\n        const brushStyle = merge(true, brushDefaultStyle, userStyle);\r\n        const userText = this.props.text ? this.props.text(idx):''\r\n        const userTextStyle = this.props.textStyle ? this.props.textStyle(idx):{}\r\n        if (!this.viewport().disjoint(timeRange)) {\r\n            const range = timeRange.intersection(this.viewport());\r\n            const begin = range.begin();\r\n            const end = range.end();\r\n            const [x, y] = [timeScale(begin), 0];\r\n            const endPos = timeScale(end);\r\n            let width = endPos - x;\r\n            if (width < 1) {\r\n                width = 1;\r\n            }\r\n\r\n            const bounds = { x, y, width, height };\r\n\r\n            return (\r\n                <g\r\n                key={`${idx}-${brushStyle}-${userText}`}\r\n                pointerEvents=\"all\"\r\n                onClick={e => this.handleMouseClick(e, idx)}\r\n                onMouseDown={e => this.handleBrushMouseDown(e, idx)}\r\n                onMouseUp={this.handleMouseUp}\r\n                ><rect\r\n                    {...bounds}                    \r\n                    style={brushStyle}                   \r\n            /><text {...userTextStyle} x={bounds.x+bounds.width/2-24} y={bounds.y+bounds.height/2+24}>{userText}</text></g>\r\n            );\r\n        }\r\n        return <g />;\r\n    }\r\n\r\n    renderHandles(timeRange, idx) {\r\n        const { timeScale, height } = this.props;\r\n\r\n        if (!timeRange) {\r\n            return <g />;\r\n        }\r\n\r\n        // Style of the handles\r\n        const handleStyle = {\r\n            fill: \"white\",\r\n            opacity: 0,\r\n            cursor: \"ew-resize\"\r\n        };\r\n\r\n        if (!this.viewport().disjoint(timeRange)) {\r\n            const range = timeRange.intersection(this.viewport());\r\n            const [begin, end] = range.toJSON();\r\n            const [x, y] = [timeScale(begin), 0];\r\n            const endPos = timeScale(end);\r\n\r\n            let width = endPos - x;\r\n            if (width < 1) {\r\n                width = 1;\r\n            }\r\n\r\n            const handleSize = this.props.handleSize;\r\n\r\n            const leftHandleBounds = { x: x - 1, y, width: handleSize, height };\r\n            const rightHandleBounds = {\r\n                x: x + (width - handleSize),\r\n                y,\r\n                width: handleSize + 1,\r\n                height\r\n            };\r\n\r\n            return (\r\n                <g>\r\n                    <rect\r\n                        {...leftHandleBounds}\r\n                        style={handleStyle}\r\n                        pointerEvents=\"all\"\r\n                        onMouseDown={e => this.handleHandleMouseDown(e, \"left\", idx)}\r\n                        onMouseUp={this.handleMouseUp}\r\n                    />\r\n                    <rect\r\n                        {...rightHandleBounds}\r\n                        style={handleStyle}\r\n                        pointerEvents=\"all\"\r\n                        onMouseDown={e => this.handleHandleMouseDown(e, \"right\", idx)}\r\n                        onMouseUp={this.handleMouseUp}\r\n                    />\r\n                </g>\r\n            );\r\n        }\r\n        return <g />;\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <g onMouseMove={this.handleMouseMove}>\r\n                {this.renderOverlay()}\r\n                {(this.props.timeRanges || []).map((timeRange, idx) => {\r\n                    return (\r\n                        <g key={`multibrush_${idx}`}>\r\n                            {this.renderBrush(timeRange, idx)}\r\n                            {this.renderHandles(timeRange, idx)}\r\n                        </g>\r\n                    );\r\n                })}\r\n            </g>\r\n        );\r\n    }\r\n}\r\n\r\nMultiBrush.propTypes = {\r\n    /**\r\n     * The timeranges for the brushes. Typically you would maintain this\r\n     * as state on the surrounding page, since it would likely control\r\n     * another page element, such as the range of the main chart. See\r\n     * also `onTimeRangeChanged()` for receiving notification of the\r\n     * brush range being changed by the user.\r\n     *\r\n     * Takes an array of Pond TimeRange object.\r\n     */\r\n    timeRanges: PropTypes.arrayOf(PropTypes.instanceOf(TimeRange)),\r\n\r\n    /**\r\n     * The brush is rendered as an SVG rect. You can specify the style\r\n     * of this rect using this prop. The brush style is a function that you\r\n     * provide. It will be called with the index of the TimeRange, corresponding\r\n     * to those in the `timeRanges` prop.\r\n     */\r\n    style: PropTypes.func, //eslint-disable-line\r\n\r\n    /**\r\n     * The size of the invisible side handles. Defaults to 6 pixels.\r\n     */\r\n    handleSize: PropTypes.number,\r\n\r\n    /**\r\n     * If this prop is false, you will only be able to draw a new brush if the last position of the timeRanges\r\n     * array is equal to null, otherwise it will allow the free drawing and the index passed to onTimeRangeChanged\r\n     * will the equal to the length of the timeRanges array\r\n     */\r\n    allowFreeDrawing: PropTypes.bool,\r\n\r\n    /**\r\n     * A callback which will be called if the brush range is changed by\r\n     * the user. It is called with a Pond TimeRange object and the index position of\r\n     * the brush in the timeRanges prop.\r\n     */\r\n    onTimeRangeChanged: PropTypes.func,\r\n\r\n    /**\r\n     * when user stop drawing or dragging box\r\n     */\r\n    onUserMouseUp: PropTypes.func,\r\n\r\n    /**\r\n     * When the user clicks one of the TimeRanges\r\n     */\r\n    onTimeRangeClicked: PropTypes.func,\r\n\r\n    /**\r\n     * [Internal] The timeScale supplied by the surrounding ChartContainer\r\n     */\r\n    timeScale: PropTypes.func,\r\n\r\n    /**\r\n     * [Internal] The width supplied by the surrounding ChartContainer\r\n     */\r\n    width: PropTypes.number,\r\n\r\n    /**\r\n     * [Internal] The height supplied by the surrounding ChartContainer\r\n     */\r\n    height: PropTypes.number\r\n};\r\n\r\nMultiBrush.defaultProps = {\r\n    handleSize: 6,\r\n    allowFreeDrawing: true\r\n};","import React from 'react';\r\nimport { format } from \"d3-format\";\r\n// Imports from the charts library\r\n\r\nimport {ChartContainer, ChartRow, Charts, YAxis, LineChart, Legend, Resizable, styler} from \"react-timeseries-charts\";\r\nimport MultiBrush from './MultiBrush'\r\nconst upDownStyle = styler([\r\n    { key: \"in\", color: \"#C8D5B8\" }, \r\n    { key: \"out\", color: \"#9BB8D7\" }\r\n]);\r\nclass TimeSeriesPlot extends React.Component {\r\n\r\n    render(){\r\n        const dateStyle = {\r\n            fontSize: 12,\r\n            color: \"#AAA\",\r\n            borderWidth: 1,\r\n            borderColor: \"#F4F4F4\"\r\n        };\r\n  \r\n        const markerStyle = {\r\n          backgroundColor: 'rgba(255, 255, 255, 0.8)',\r\n          color: \"#AAA\",\r\n          marginLeft: \"5px\"\r\n        }\r\n  \r\n        const axistype = \"linear\";\r\n        const tracker = this.props.tracker ? `${this.props.tracker}` : \"\";\r\n        const formatter = format(\".4s\");\r\n  \r\n        return (\r\n            <div>\r\n                {/*\r\n                <div className=\"row\">\r\n                    <div className=\"col-md-4\">\r\n                        <Legend\r\n                            type=\"swatch\"\r\n                            style={upDownStyle}\r\n                            categories={[\r\n                                { key: \"in\", label: \"Into Site\" },\r\n                                { key: \"out\", label: \"Out of site\" }\r\n                            ]}\r\n                        />\r\n                    </div>\r\n                    <div className=\"col-md-8\">\r\n                        <span style={dateStyle}>{tracker}</span>\r\n                        </div>\r\n                </div>\r\n                */}\r\n                <hr />\r\n  \r\n                <div className=\"row\">\r\n                    <div className=\"col-md-12\">\r\n                        { this.props.tracker ?\r\n                            <div style={{position: 'relative'}}>\r\n                                <div style={{position: 'absolute', left: this.props.trackerX}}>\r\n                                    <div style={markerStyle}>Data In: {formatter(this.props.trackerEventIn.get('in'))}</div>\r\n                                </div>\r\n                            </div>\r\n                        : null }\r\n                        <Resizable>\r\n                            <ChartContainer\r\n                                timeRange={this.props.timerange}\r\n                                format={\"year\"}\r\n                                trackerPosition={this.props.tracker}\r\n                                onTrackerChanged={this.props.handleTrackerChanged}\r\n                                enablePanZoom={false}\r\n                                maxTime={this.props.timerange.end()}\r\n                                minTime={this.props.timerange.begin()}\r\n                                minDuration={1000 * 60 * 60}\r\n                                onBackgroundClick={this.props.onBackgroundClick}\r\n                                onTimeRangeChanged={this.props.handleTimeRangeChange}\r\n                            >\r\n                                <ChartRow height=\"250\" debug={false}>\r\n                                    <Charts>\r\n                                        <LineChart\r\n                                            axis=\"traffic\"\r\n                                            series={this.props.data}\r\n                                            columns={[\"in\"]}\r\n                                            style={upDownStyle}\r\n                                        />\r\n                                        <MultiBrush\r\n                                            timeRanges={this.props.selections}\r\n                                            style={i => {\r\n                                                if (i === this.props.selected) {\r\n                                                    return { fill: \"#46abff\" };\r\n                                                } else {\r\n                                                    return { fill: \"#cccccc\" };\r\n                                                }\r\n                                            }}\r\n                                            text={i => {\r\n                                                return this.props.getText?this.props.getText(i):''\r\n                                            }}\r\n                                            textStyle={i => {\r\n                                                return this.props.getTextStyle?this.props.getTextStyle(i):{}\r\n                                            }}\r\n                                            allowSelectionClear\r\n                                            onTimeRangeChanged={this.props.handleSelectionChange}\r\n                                            onTimeRangeClicked={this.props.onTimeRangeClicked}\r\n                                        />\r\n                                    </Charts>\r\n                                    <YAxis\r\n                                        id=\"traffic\"\r\n                                        label=\"Traffic (bps)\"\r\n                                        labelOffset={0}\r\n                                        min={this.props.minSignal}\r\n                                        max={this.props.maxSignal}\r\n                                        absolute={true}\r\n                                        width=\"60\"\r\n                                        type={axistype}\r\n                                    />\r\n                                </ChartRow>\r\n                            </ChartContainer>\r\n                        </Resizable>\r\n                    </div>\r\n                    \r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\nexport default TimeSeriesPlot;","import React from 'react';\r\nimport TimeSeriesPlot from '../components/TimeSeriesPlot'\r\nimport _ from 'lodash'\r\n// Pond\r\nimport { TimeSeries, TimeRange } from \"pondjs\";\r\nimport {getQualifications, listQualifications, sendQualificationsReq} from \"../api\";\r\nimport * as tf from '@tensorflow/tfjs'\r\nimport {Row, Button, Spinner, OverlayTrigger, Popover} from \"react-bootstrap\";\r\n/**\r\n * DATA\r\n */\r\nconst visibleNumPeriods = 3\r\nconst selectedAt = 1\r\nconst secondsInPeriod = 10\r\nconst labels_dict = {0 : 'W', 1 : 'NR', 2 : 'R'};\r\nconst labelsInput = {'w' : 'W', 'e' : 'NR', 'r' : 'R','W' : 'W', 'E' : 'NR', 'R' : 'R'};\r\nvar totalRecords = 0\r\n\r\nconst helpPopover = (\r\n    <Popover id=\"popover-basic\">\r\n        <Popover.Title as=\"h3\">Keyboard shortcuts</Popover.Title>\r\n        <Popover.Content>\r\n            To select the <strong>predicted</strong> state:\r\n            <ul>\r\n                <li>press spacebar</li>\r\n            </ul>\r\n            {/*<br/>*/}\r\n            To select your own state:\r\n            <ul>\r\n                <li>key w: <strong>W</strong></li>\r\n                <li>key e: <strong>NR</strong></li>\r\n                <li>key r: <strong>R</strong></li>\r\n            </ul>\r\n            To move to next/previous selection:\r\n            <ul>\r\n                <li>right arrow key: <strong>Move right</strong></li>\r\n                <li>left arrow key: <strong>Move left</strong></li>\r\n            </ul>\r\n        </Popover.Content>\r\n    </Popover>\r\n);\r\n\r\nasync function predict(model, array) {\r\n    function array_to_tensor(array) {\r\n        const shape = [1, 5000, 2];\r\n        const tensor = tf.tensor3d(array, shape, \"float32\");\r\n        return tensor\r\n    }\r\n    const tensor =  array_to_tensor(array)\r\n    const prediction = model.predict(tensor).dataSync();\r\n    const prediction_arr = Array.from(prediction)\r\n\r\n    const score = labels_dict[prediction_arr.indexOf(_.max(prediction_arr))];\r\n    return score\r\n}\r\n\r\n/**\r\n * UTILS\r\n */\r\n\r\nconst breakTimeRange = (t0, t1, numCuts)=>{\r\n    let period = Math.floor((t1-t0)/numCuts)\r\n    return Array.apply(null,Array(numCuts+1)).map((n,i)=>{            \r\n        let initTime = parseInt((t0+i*period))\r\n        let finalTime = parseInt((t0+(i+1)*period))\r\n        if (i === numCuts){\r\n            return new TimeRange(initTime,t1)\r\n        }\r\n        return new TimeRange(initTime,finalTime)\r\n    })\r\n}\r\n\r\nconst cutTimeSeries = (data, offsetData, length)=>{\r\n    return data.slice(offsetData,parseInt(offsetData+length))\r\n}\r\n\r\nconst getAmplitude = (data)=>{\r\n    return Math.max(Math.abs(data.collection().max('in')), Math.abs(data.collection().min('in')))\r\n}\r\n\r\nclass Dashboard extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        //console.log(initEEG)\r\n        // listQualifications().then((list) => {\r\n        //     if (list) {\r\n        //         console.log(\"HAH\", list);\r\n        //     }\r\n        // });\r\n        //const max = Math.max(Math.abs(this.props.data.collection().max('in')), Math.abs(this.props.data.collection().min('in')))\r\n        //let initEMG = EMG.slice(beginTime*1000,endTime*1000)\r\n        this.state = {\r\n            EEG: null,//.slice(beginTime, beginTime+(initialPeriod*1000)*3.5)\r\n            EMG: null,\r\n            offsetData: 0,\r\n            tracker: null,\r\n            timerange: null,\r\n            selected: 0,\r\n            selections:null,\r\n            qualifications: {},\r\n            prediction: null,\r\n            trackerEventIn_EEG: null,\r\n            trackerEventIn_EMG: null,\r\n            trackerEventOut_EEG: null,\r\n            trackerEventOut_EMG: null,\r\n            trackerX: null,\r\n            showAlert: null\r\n        };\r\n    }\r\n    getText = (i)=>{\r\n        if (this.state.qualifications[i+this.state.offsetData]!=null){\r\n            return this.state.qualifications[i+this.state.offsetData]\r\n        } else if(i===this.state.selected) {\r\n            return this.state.prediction\r\n        }\r\n    }\r\n    getTextStyle = (i)=>{\r\n        if (this.state.qualifications[i+this.state.offsetData]!=null){\r\n            return {'fill':'#0057c2', 'fontSize': 48}\r\n        } else if(i===this.state.selected) {\r\n            return {'fill':'#bf9300','fontSize': 48 }\r\n        }\r\n    }\r\n    handleTrackerChanged = (t, scale) => {\r\n        this.setState({\r\n            tracker: t,\r\n            trackerEventIn_EEG: t && this.state.EEG.at(this.state.EEG.bisect(t)),\r\n            trackerEventIn_EMG: t && this.state.EMG.at(this.state.EMG.bisect(t)),\r\n            trackerEventOut_EEG: t && this.state.EEG.at(this.state.EEG.bisect(t)),\r\n            trackerEventOut_EMG: t && this.state.EMG.at(this.state.EMG.bisect(t)),\r\n            trackerX: t && scale(t)\r\n        });\r\n    }\r\n\r\n    handleTimeRangeChange = timerange => {\r\n        this.setState({ timerange });\r\n    }\r\n    handleSelectionChange = (timerange, i) => {\r\n        //Blocked\r\n        //const selections = this.state.selections;\r\n        //selections[i] = timerange;\r\n        //this.setState({ selections });\r\n    }\r\n    onBackgroundClick = ()=>{\r\n        this.setState({ selection: null, prediction: null })\r\n    }\r\n    onTimeRangeClicked = (i)=>{\r\n        let newSelected = i%visibleNumPeriods\r\n        this.getPrediction(this.state.offsetData+newSelected).then((pred)=>{\r\n            this.setState({ selected: newSelected, prediction: pred })\r\n        })\r\n    }\r\n    getPrediction = (i, model=null)=>{\r\n        // i == offsetData+selected\r\n        let valEEG =  this.props.edf.getPhysicalSignalConcatRecords(0, (i)*secondsInPeriod, secondsInPeriod)\r\n        let valEMG =  this.props.edf.getPhysicalSignalConcatRecords(1, (i)*secondsInPeriod, secondsInPeriod)\r\n        let concat = Array.from(valEEG).concat(Array.from(valEMG))\r\n        if (!model) model = this.state.model\r\n        return predict(model, Float32Array.from(concat))\r\n    }\r\n    edfParser = (offsetData=0)=>{\r\n        let edf = this.props.edf\r\n        if (!edf) return\r\n        // http://www.pixpipe.io/edfdecoder/doc/\r\n        totalRecords = edf.getNumberOfRecords()\r\n        // console.log(\"Total: \", totalRecords);\r\n        let standardLength = edf.getRawSignal(0,0).length\r\n        let lastLength = edf.getRawSignal(0,totalRecords-1).length\r\n        let secondsInRecord = edf.getRecordDuration()\r\n        let beginTime = edf.getRecordingStartDate().getTime()\r\n\r\n        let valuesEEG = edf.getPhysicalSignalConcatRecords(0, offsetData*secondsInPeriod, visibleNumPeriods*secondsInPeriod)\r\n        // Object.values(sample[\"EMG\"]).map( (p,i) => [parseInt((beginTime+i*timeDelta) * 1000), p])\r\n        let multiplier = 1 // beginTime>0?1:-1\r\n        let mapTime = _.map(valuesEEG.slice(0,10), (p,i) => {\r\n            return beginTime+multiplier*(i+offsetData*secondsInPeriod)*secondsInRecord * 1000\r\n        })\r\n        //console.log(mapTime)\r\n        let timeSeriesEEG = new TimeSeries({\r\n            name: `EEG`,\r\n            columns: [\"time\", \"in\"],\r\n            points: _.map(valuesEEG, (p,i) => [parseInt(beginTime+multiplier*(i+offsetData*secondsInPeriod)*secondsInRecord * 100), p])\r\n        });\r\n        let valuesEMG = edf.getPhysicalSignalConcatRecords(1, offsetData*secondsInPeriod, visibleNumPeriods*secondsInPeriod)\r\n        // Object.values(sample[\"EMG\"]).map( (p,i) => [parseInt((beginTime+i*timeDelta) * 1000), p])\r\n        let timeSeriesEMG = new TimeSeries({\r\n            name: `EMG`,\r\n            columns: [\"time\", \"in\"],\r\n            points: _.map(valuesEMG,  (p,i) => [parseInt(beginTime+multiplier*(i+offsetData*secondsInPeriod)*secondsInRecord * 100), p])\r\n        });\r\n        let selections = breakTimeRange(timeSeriesEEG.timerange().toJSON()[0], timeSeriesEEG.timerange().toJSON()[1], visibleNumPeriods)\r\n        return [timeSeriesEEG, timeSeriesEMG, selections]\r\n    }\r\n    _handleKeyDown = (event) => {\r\n        this.setState({showAlert: null});\r\n        // let numCuts =(endTime-beginTime)/initialPeriod //TOTAL DE TALLS\r\n        let selected = this.state.selected\r\n        let offset = this.state.offsetData\r\n        let eventKey = event.key\r\n        let qualifications =  this.state.qualifications\r\n        if (Object.keys(labelsInput).indexOf(eventKey) !== -1){\r\n            qualifications={...qualifications,[offset+selected]:labelsInput[event.key]}\r\n            eventKey='ArrowRight'\r\n        }else if(eventKey==' '){\r\n            qualifications={...qualifications,[offset+selected]:this.state.prediction}\r\n            eventKey='ArrowRight'\r\n        }\r\n        //https://keycode.info/\r\n        switch(eventKey){\r\n            case 'PageUp':\r\n                offset = offset+visibleNumPeriods\r\n                break;\r\n            case 'PageDown':\r\n                offset = offset-visibleNumPeriods>0?offset-visibleNumPeriods:0\r\n                break;\r\n            case 'ArrowRight':\r\n                //if (true)  // at the end\r\n                if (selected<selectedAt){\r\n                    selected+=1\r\n                }else{\r\n                    offset+=1\r\n                }\r\n                break;\r\n            case 'ArrowLeft':\r\n                if (offset>0)offset-=1\r\n                else{\r\n                    if (selected>0){\r\n                        selected-=1\r\n                    }\r\n                }\r\n                break;\r\n            default:\r\n                break\r\n        }\r\n        if (offset!=this.state.offsetData) {\r\n            let parsed = this.edfParser(offset)\r\n            let timeSeriesEEG = parsed[0]\r\n            let timeSeriesEMG = parsed[1]\r\n            let selections = parsed[2]\r\n            this.getPrediction(offset+selected).then((pred)=>{\r\n                this.setState({\r\n                    EEG: timeSeriesEEG,\r\n                    EMG: timeSeriesEMG,\r\n                    offsetData: offset,\r\n                    selected:selected,\r\n                    timerange: timeSeriesEEG.range(),\r\n                    selections: selections,\r\n                    qualifications: qualifications,\r\n                    prediction: pred\r\n                })\r\n            })\r\n        }else{\r\n            this.getPrediction(offset+selected).then((pred)=>{\r\n                this.setState({selected:selected, qualifications: qualifications, prediction:pred})\r\n            })\r\n        }\r\n        /*\r\n        this.setState((state)=>{\r\n            return {\r\n                selected:selected, \r\n                offsetData:offset,\r\n                timerange: newEEG.range(),\r\n                EEG:newEEG,\r\n                EMG:newEMG,\r\n                qualifications: qualifications\r\n            }\r\n        })*/\r\n    }\r\n    send_selections = (event) => {\r\n        // console.log(\"send\", this.state.qualifications);\r\n        // console.log(\"timerange\", this.state.EEG, this.state.EMG);\r\n        sendQualificationsReq(this.props.name || 'test', totalRecords, this.state.qualifications).then((success) => {\r\n            this.setState({showAlert: success});\r\n        });\r\n        event.target.blur();\r\n    }\r\n    load_selections = (event) => {\r\n        if (window.confirm('This will delete all your unsaved selections. Proceed?')) {\r\n            // console.log(\"load\", event)\r\n            this.setState({showAlert: 'spin'});\r\n            getQualifications(this.props.name).then((qualifications) => {\r\n                console.log(\"neki\", qualifications);\r\n                if (qualifications) {\r\n                    this.setState({\r\n                        qualifications: qualifications,\r\n                        showAlert: true\r\n                    });\r\n                } else this.setState({showAlert: false});\r\n            });\r\n        }\r\n        event.target.blur();\r\n    }\r\n    componentDidMount(){\r\n        document.addEventListener(\"keydown\", _.debounce(this._handleKeyDown,50));\r\n    }\r\n    componentWillUnmount() {\r\n        document.removeEventListener(\"keydown\", _.debounce(this._handleKeyDown, 50));\r\n    }\r\n    componentDidUpdate(prevProps, prevState) {\r\n        if (this.props.edf!=null && prevProps.edf!==this.props.edf){\r\n            let parsed = this.edfParser(0)\r\n            let timeSeriesEEG = parsed[0]\r\n            let timeSeriesEMG = parsed[1]\r\n            let selections = parsed[2]\r\n            tf.loadLayersModel('https://raw.githubusercontent.com/AgileDS/AutoScorer/model_dev/model/TF-js/1CNN-Model/model.json').then((model)=>{\r\n                this.getPrediction(0, model).then((prediction)=>{\r\n                    this.setState({\r\n                        EEG: timeSeriesEEG,//.slice(beginTime, beginTime+(initialPeriod*1000)*3.5)\r\n                        EMG: timeSeriesEMG,\r\n                        timerange: timeSeriesEEG.range(),\r\n                        selections: selections,\r\n                        model: model,\r\n                        prediction:prediction\r\n                    })\r\n                })\r\n            })\r\n        }\r\n    }\r\n    render(){\r\n        if (!this.props.edf) {\r\n            return (<div/>)\r\n        }\r\n        return (\r\n            <div>\r\n                <Row align='center' className=\"mt-md-1 mr-1\">\r\n                    <div className=\"col-8 d-inline-flex justify-content-md-end align-items-center\">\r\n                        <Button className='mr-md-5 No-focus' onClick={this.load_selections}>Load selections</Button>\r\n                        <Button className='ml-md-5 No-focus' onClick={this.send_selections}>Save selections</Button>\r\n                    </div>\r\n                    <div className=\"col-1 d-inline-flex align-items-center\">\r\n                        { this.state.showAlert === true ?\r\n                            <div className=\" ml-md-2 badge badge-success\" role=\"alert\"> Success! </div>  :\r\n                            this.state.showAlert === false ?\r\n                                <div className=\"badge badge-danger\" role=\"alert\"> Something went wrong! </div>  :\r\n                                this.state.showAlert === 'spin' ?\r\n                                    <Spinner animation=\"border\" variant=\"secondary\"  /> : null\r\n                        }\r\n                    </div>\r\n                    <div className=\"col-3\" align='right' >\r\n                        <OverlayTrigger trigger=\"click\" placement=\"left\" overlay={helpPopover}>\r\n                        <a tabindex=\"0\"  className='btn btn-light ml-md-5 No-focus float-right'>\r\n                            Help\r\n                        </a>\r\n\r\n                        </OverlayTrigger>\r\n                    </div>\r\n                </Row>\r\n                { this.state.EEG ? <TimeSeriesPlot\r\n                    data={this.state.EEG}\r\n                    //tracker={this.state.tracker}\r\n                    timerange={this.state.timerange} \r\n                    selected={this.state.selected} \r\n                    selections={this.state.selections}\r\n                    /*trackerEventIn={this.state.trackerEventIn_EEG}\r\n                    trackerEventOut={this.state.trackerEventIn_EEG}\r\n                    trackerX={this.state.trackerX}*/\r\n                    handleTrackerChanged={this.handleTrackerChanged}\r\n                    handleTimeRangeChange={this.handleTimeRangeChange}\r\n                    handleSelectionChange={this.handleSelectionChange}\r\n                    onBackgroundClick={this.onBackgroundClick}\r\n                    onTimeRangeClicked={this.onTimeRangeClicked}\r\n                    maxSignal={800}\r\n                    minSignal={-800}\r\n                    getText={this.getText}\r\n                    getTextStyle={this.getTextStyle}\r\n                />:\r\n                <div align=\"center\" style={{'minWidth': '100%'}} className=\"mt-md-5\">\r\n                    <Spinner  align=\"center\" style={{'minWidth': '10em', 'minHeight':'10em'}}  animation=\"grow\" variant=\"secondary\"  />\r\n                </div>  }\r\n                {this.state.EMG ?<TimeSeriesPlot\r\n                    data={this.state.EMG}\r\n                    //tracker={this.state.tracker}\r\n                    timerange={this.state.timerange} \r\n                    selected={this.state.selected} \r\n                    selections={this.state.selections}\r\n                    /*trackerEventIn={this.state.trackerEventIn_EMG}\r\n                    trackerEventOut={this.state.trackerEventOut_EMG}\r\n                    trackerX={this.state.trackerX}*/\r\n                    handleTrackerChanged={this.handleTrackerChanged}\r\n                    handleTimeRangeChange={this.handleTimeRangeChange}\r\n                    handleSelectionChange={this.handleSelectionChange}\r\n                    onBackgroundClick={this.onBackgroundClick}\r\n                    onTimeRangeClicked={this.onTimeRangeClicked}\r\n                    maxSignal={6000}\r\n                    minSignal={-6000}\r\n                    getText={this.getText}\r\n                    getTextStyle={this.getTextStyle}\r\n                />: null}\r\n            </div>\r\n        )\r\n    }\r\n}\r\nexport default Dashboard;\r\n  ","import React from 'react'\r\nimport {EdfDecoder} from 'edfdecoder'\r\nimport Form from \"react-bootstrap/Form\";\r\nimport Button from \"react-bootstrap/Button\";\r\nimport Jumbotron from \"react-bootstrap/Jumbotron\";\r\nimport {Spinner} from \"react-bootstrap\";\r\n\r\nclass UploadForm extends React.Component {\r\n  constructor(props) {\r\n      super(props);\r\n      this.state = {\r\n        spinner:false\r\n      };\r\n  }\r\n\r\n\r\n  render(props){\r\n    return(\r\n    <div align=\"center\" className=\"vh-100 center-block align-middle\">\r\n        <Jumbotron>\r\n            <h1>Hello to your favourite AutoScorer!</h1>\r\n            <p> Just one more step to get to the dashboard &#128516; </p>\r\n        </Jumbotron>\r\n        <div align=\"center\" className='mt-3 pt-3' style={{'maxWidth': 20 + 'em'}}>\r\n          <Form.Control className=\"d-inline-flex p-2 align-middle\" type=\"file\" onChange={this.setFile.bind(this)} accept='.edf'/>\r\n        </div>\r\n        {this.state.spinner ? <Spinner animation=\"border\" variant=\"secondary\"  /> : null}\r\n      </div>\r\n    )\r\n  }\r\n  postFile(event) {   \r\n    // HTTP POST  \r\n  }\r\n  setFile(event) {\r\n    this.setState({spinner: true})\r\n      // console.log(\"spinner on\")\r\n    // Get the details of the files\r\n    let file = event.target.files[0]\r\n    let filename = event.target.files[0].name;\r\n    let decoder = new EdfDecoder();\r\n    /*event.target.files[0].arrayBuffer((buff)=>{\r\n        decoder.setInput(buff);        \r\n        decoder.decode();\r\n        let myEdf = decoder.getOutput();\r\n    })*/\r\n    if (file != null){\r\n      let reader = new FileReader();\r\n      reader.onloadend = ()=>{\r\n        let decoder = new EdfDecoder();\r\n        let buff = reader.result;\r\n        decoder.setInput(buff);        \r\n        decoder.decode();\r\n        this.props.handleData(decoder.getOutput(), filename)\r\n      }\r\n      reader.readAsArrayBuffer(file);\r\n      // this.setState({spinner: false})\r\n      //   console.log(\"spinner off\")\r\n    }\r\n    \r\n  }\r\n}\r\n\r\nexport default UploadForm;","import React from 'react';\r\nimport './App.css';\r\nimport {\r\n  HashRouter as Router,\r\n  Switch,\r\n  Route,\r\n  Redirect\r\n} from \"react-router-dom\";\r\nimport Login from './login/Login'\r\nimport Register from './register/Register'\r\nimport Dashboard from './dashboard/Dashboard'\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport UploadForm from './dashboard/UploadForm';\r\n\r\nclass App extends React.Component {\r\n  state={\r\n    edf:null,\r\n    name:null\r\n  }\r\n  render(){\r\n    return (\r\n      <Router basename='/'>\r\n        <div>\r\n          <Switch>\r\n            <Route exact path=\"/\">\r\n              <Redirect to=\"/login\"/>\r\n            </Route>\r\n            <Route path=\"/login\">\r\n              <Login/>\r\n            </Route>\r\n            <Route path=\"/dashboard\">\r\n              {!this.state.edf ? <UploadForm handleData={(data, filename) => {\r\n                  this.setState({\r\n                      edf:data,\r\n                      name:filename})\r\n                }}/> : null\r\n              }\r\n              <Dashboard edf={this.state.edf} name={this.state.name}/>\r\n            </Route>\r\n            <Route path=\"/register\">\r\n                <Register/>\r\n            </Route>\r\n          </Switch>\r\n        </div>\r\n      </Router>\r\n    );\r\n  }\r\n}\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}